(window.webpackJsonp=window.webpackJsonp||[]).push([[6],{269:function(v,_,t){v.exports=t.p+"assets/img/audiosystem2.3758a32d.svg"},270:function(v,_,t){v.exports=t.p+"assets/img/audiosystem1.c7bf9082.svg"},290:function(v,_,t){"use strict";t.r(_);var a=t(13),s=Object(a.a)({},(function(){var v=this,_=v._self._c;return _("ContentSlotsDistributor",{attrs:{"slot-key":v.$parent.slotKey}},[_("h1",{attrs:{id:"音频子系统"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#音频子系统"}},[v._v("#")]),v._v(" 音频子系统")]),v._v(" "),_("div",{staticClass:"custom-block warning"},[_("p",{staticClass:"custom-block-title"},[v._v("TODO")]),v._v(" "),_("p",[v._v("本段描述的特性可能尚未完全暴露在 API 中。")])]),v._v(" "),_("p",[v._v("LSTGPlus 的音频系统主要面向 2D 游戏设计，因此不具备复杂的 3D 空间音频功能。")]),v._v(" "),_("p",[v._v("音频总线工作在"),_("code",[v._v("44100 Hz")]),v._v("采样率、立体声、"),_("code",[v._v("32bit float")]),v._v("量化格式下，所有音频数据在经过总线处理前都会转换为该格式。")]),v._v(" "),_("p",[v._v("在多线程可用环境下，音频处理会工作在单独的线程上，以防止对游戏主线程的影响。在多线程不可用环境下（如"),_("code",[v._v("emscripten")]),v._v("），将会在帧更新中同步进行音频处理。")]),v._v(" "),_("h2",{attrs:{id:"基本概念"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#基本概念"}},[v._v("#")]),v._v(" 基本概念")]),v._v(" "),_("h3",{attrs:{id:"音频数据"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#音频数据"}},[v._v("#")]),v._v(" 音频数据")]),v._v(" "),_("p",[v._v("音频数据用于表示可供播放的 PCM 波形数据，当前支持从下述文件类型中加载波形数据：")]),v._v(" "),_("ul",[_("li",[v._v("wav")]),v._v(" "),_("li",[v._v("aiff")]),v._v(" "),_("li",[v._v("au")]),v._v(" "),_("li",[v._v("voc")]),v._v(" "),_("li",[v._v("flac")]),v._v(" "),_("li",[v._v("ogg/vorbis")]),v._v(" "),_("li",[v._v("raw")]),v._v(" "),_("li",[v._v("shn")]),v._v(" "),_("li",[v._v("mp3")])]),v._v(" "),_("p",[v._v("存储上，LSTGPlus 中具有两种类型："),_("code",[v._v("缓冲区式")]),v._v("、"),_("code",[v._v("流式")]),v._v("。对于缓冲区式数据，LSTGPlus 会预先解码所有数据并存储到缓冲区中，由于我们内部使用的音频数据格式采取浮点数存储，因此其内存占用会显著增大；对于流式数据，LSTGPlus 会在播放的同时进行解码操作，内存占用小但是会增加 CPU 消耗。")]),v._v(" "),_("p",[v._v("在API侧，当使用"),_("code",[v._v("LoadSound")]),v._v("时我们将使用缓冲区式方式进行数据存储；当使用"),_("code",[v._v("LoadMusic")]),v._v("时我们将使用流式方式进行数据存储。")]),v._v(" "),_("h3",{attrs:{id:"音频源"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#音频源"}},[v._v("#")]),v._v(" 音频源")]),v._v(" "),_("p",[v._v("音频源用于标识音频数据的播放状态和参数。")]),v._v(" "),_("h4",{attrs:{id:"音量"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#音量"}},[v._v("#")]),v._v(" 音量")]),v._v(" "),_("p",[v._v("音量用于控制音频源的播放响度，LSTGPlus 中使用"),_("a",{attrs:{href:"https://en.wikipedia.org/wiki/Neper",target:"_blank",rel:"noopener noreferrer"}},[v._v("线性值"),_("OutboundLink")],1),v._v("来描述音量，你可以通过公式在分贝和线性值之间进行转换。")]),v._v(" "),_("table",[_("thead",[_("tr",[_("th",[v._v("线性值")]),v._v(" "),_("th",[v._v("分贝")])])]),v._v(" "),_("tbody",[_("tr",[_("td",[v._v("0.0")]),v._v(" "),_("td",[v._v("-200 dB")])]),v._v(" "),_("tr",[_("td",[v._v("0.25")]),v._v(" "),_("td",[v._v("-12 dB")])]),v._v(" "),_("tr",[_("td",[v._v("0.5")]),v._v(" "),_("td",[v._v("-6 dB")])]),v._v(" "),_("tr",[_("td",[v._v("1.0")]),v._v(" "),_("td",[v._v("0 dB")])])])]),v._v(" "),_("h4",{attrs:{id:"平衡"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#平衡"}},[v._v("#")]),v._v(" 平衡")]),v._v(" "),_("p",[v._v("平衡用于控制音频源在左右声道中的比重，当值取"),_("code",[v._v("-1")]),v._v("，声音将只在左声道发出；当值取"),_("code",[v._v("1")]),v._v("，声音将只在右声道发出；默认值为"),_("code",[v._v("0")]),v._v("。")]),v._v(" "),_("h4",{attrs:{id:"循环节"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#循环节"}},[v._v("#")]),v._v(" 循环节")]),v._v(" "),_("p",[v._v("循环节用于指定播放时的循环起止位置，当播放位置达到循环尾时，播放头会自动调回到循环头进行播放。")]),v._v(" "),_("div",{staticClass:"custom-block tip"},[_("p",{staticClass:"custom-block-title"},[v._v("TIP")]),v._v(" "),_("p",[v._v("在 Legacy API 中，音频源会和资产绑定，即每个音频资产至多绑定一个音频源，换言之，当播放音频资产时，上一个播放的音频源会被终止。")])]),v._v(" "),_("h3",{attrs:{id:"总线"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#总线"}},[v._v("#")]),v._v(" 总线")]),v._v(" "),_("p",[v._v("总线用于混合音频的波形数据，并在其上施加音频效果处理。总线可供配置的内容如图所示：")]),v._v(" "),_("p",[_("img",{attrs:{src:t(269),alt:"总线链路"}})]),v._v(" "),_("p",[v._v("默认的，LSTGPlus 中提供了一个四路的混音器，可以进行简单的音频效果处理。默认的链路拓扑如下图所示：")]),v._v(" "),_("p",[_("img",{attrs:{src:t(270),alt:"音频系统链路"}})]),v._v(" "),_("p",[v._v("我们会将"),_("code",[v._v("BUS 0")]),v._v("用于混合最终的音频数据，并进行压限处理；"),_("code",[v._v("BUS 1")]),v._v("用于接收和处理"),_("code",[v._v("PlayMusic")]),v._v("调用播放的背景音乐；"),_("code",[v._v("BUS 2")]),v._v("用于接收和处理"),_("code",[v._v("PlaySound")]),v._v("调用播放的音效数据。")]),v._v(" "),_("p",[v._v("当调用"),_("code",[v._v("SetBGMVolume")]),v._v("时将等价于调整"),_("code",[v._v("BUS 1")]),v._v("的音量，当调用"),_("code",[v._v("SetSEVolume")]),v._v("时将等价于调整"),_("code",[v._v("BUS 2")]),v._v("的音量。")]),v._v(" "),_("h4",{attrs:{id:"效果链"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#效果链"}},[v._v("#")]),v._v(" 效果链")]),v._v(" "),_("p",[v._v("效果链用于配置 DSP 插件，音频数据将经由各 DSP 插件进行处理。")]),v._v(" "),_("h4",{attrs:{id:"发送"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#发送"}},[v._v("#")]),v._v(" 发送")]),v._v(" "),_("p",[_("code",[v._v("发送")]),v._v("用于将总线中处理的音频数据拷贝并转发到其他总线上，同其他总线数据混合处理。")]),v._v(" "),_("p",[v._v("需要注意各总线的"),_("code",[v._v("发送")]),v._v("可能会构成环，当某次配置操作出现环时，操作会失败。")]),v._v(" "),_("h4",{attrs:{id:"输出"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#输出"}},[v._v("#")]),v._v(" 输出")]),v._v(" "),_("p",[_("code",[v._v("输出")]),v._v("用于指定总线的混合结果输出到哪个总线上，或者输出到音频设备缓冲区中。")]),v._v(" "),_("h2",{attrs:{id:"调试gui支持"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#调试gui支持"}},[v._v("#")]),v._v(" 调试GUI支持")]),v._v(" "),_("p",[v._v("你可以通过"),_("code",[v._v("调试控制台")]),v._v("唤出混音器GUI界面。")]),v._v(" "),_("p",[v._v("详见"),_("code",[v._v("调试控制台")]),v._v("章节。")])])}),[],!1,null,null,null);_.default=s.exports}}]);