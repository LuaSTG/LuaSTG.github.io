(window.webpackJsonp=window.webpackJsonp||[]).push([[11],{271:function(v,_,t){v.exports=t.p+"assets/img/vfssystem.c2a1c8c4.svg"},294:function(v,_,t){"use strict";t.r(_);var s=t(13),a=Object(s.a)({},(function(){var v=this,_=v._self._c;return _("ContentSlotsDistributor",{attrs:{"slot-key":v.$parent.slotKey}},[_("h1",{attrs:{id:"文件子系统"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#文件子系统"}},[v._v("#")]),v._v(" 文件子系统")]),v._v(" "),_("p",[v._v("为了在各种平台上执行，屏蔽各系统文件系统区别，同时支持在不同场景下的文件存取，我们在 LuaSTGPlus 中引入了虚拟文件系统的概念。")]),v._v(" "),_("ul",[_("li",[v._v("特点\n"),_("ul",[_("li",[v._v("根路径为"),_("code",[v._v("/")])]),v._v(" "),_("li",[v._v("以"),_("code",[v._v("/")]),v._v("作为分隔符（"),_("code",[v._v("\\")]),v._v("会被自动转换为"),_("code",[v._v("/")]),v._v("）")]),v._v(" "),_("li",[v._v("大小写敏感")])])])]),v._v(" "),_("h2",{attrs:{id:"内建路径"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#内建路径"}},[v._v("#")]),v._v(" 内建路径")]),v._v(" "),_("p",[v._v("虚拟文件系统定义有两个固定的路径：")]),v._v(" "),_("ul",[_("li",[v._v("/\n"),_("ul",[_("li",[v._v("storage/")]),v._v(" "),_("li",[v._v("assets/")])])])]),v._v(" "),_("p",[v._v("其中"),_("code",[v._v("/storage/")]),v._v("用于指向用户数据存储目录，"),_("code",[v._v("/assets/")]),v._v("用于指向资产目录。")]),v._v(" "),_("h3",{attrs:{id:"用户数据存储目录"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#用户数据存储目录"}},[v._v("#")]),v._v(" 用户数据存储目录")]),v._v(" "),_("p",[v._v("用户数据存储目录用于屏蔽各个系统下"),_("code",[v._v("UserData")]),v._v("文件夹的差异。")]),v._v(" "),_("p",[v._v("构建时的"),_("code",[v._v("LSTG_APP_NAME")]),v._v("定义将会影响这一目录的实际位置。")]),v._v(" "),_("ul",[_("li",[v._v("各平台用户数据实际存储路径\n"),_("ul",[_("li",[v._v("Windows："),_("code",[v._v("%APPDATA%\\Roaming\\lstgplus\\default\\")])]),v._v(" "),_("li",[v._v("Linux: "),_("code",[v._v("~/.local/share/lstgplus/default/")])]),v._v(" "),_("li",[v._v("MacOS: "),_("code",[v._v("~/Library/Application Support/lstgplus/default/")])])])])]),v._v(" "),_("p",[v._v("代码可以在用户数据存储目录中进行读写操作。")]),v._v(" "),_("h3",{attrs:{id:"资产目录"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#资产目录"}},[v._v("#")]),v._v(" 资产目录")]),v._v(" "),_("p",[v._v("资产目录的构成相对用户数据存储目录复杂。")]),v._v(" "),_("p",[v._v("资产目录由层叠文件系统构成，访问会依次经由各个文件系统进行，当上一个文件系统不存在对应文件时，会继续调用下一个文件系统进行操作，直到遍历完成所有层叠的文件系统。")]),v._v(" "),_("p",[_("img",{attrs:{src:t(271),alt:"层叠文件系统"}})]),v._v(" "),_("p",[v._v("层叠文件系统在当前实现中由 Zip 文件系统构成，对应"),_("code",[v._v("LoadPack")]),v._v("方法加载的若干 Zip 文件构成的虚拟文件系统。越先加载的 Zip 数据包会越晚参与层叠文件系统的访问，换言之，当加载文件时，会优先搜索最近加载的 Zip 数据包。")]),v._v(" "),_("p",[v._v("除此以外，层叠文件系统最后尾会加入一个本地文件系统，注意到"),_("code",[v._v("LoadPack")]),v._v("方法本质也是在虚拟文件系统上进行的访问，因此在没有加载任何 Zip 数据包时，"),_("code",[v._v("LoadPack")]),v._v("会从本地文件系统中打开 Zip 数据包并进行数据加载。与此同时，在开发模式下，通过这一机制可以规避打包 Zip 的麻烦，直接在本地文件系统中进行开发。")]),v._v(" "),_("p",[v._v("需要注意，在"),_("strong",[v._v("开发模式")]),v._v("中，该本地文件系统会映射到当前程序的工作路径；而在"),_("strong",[v._v("发布模式")]),v._v("中，则始终映射到程序的执行目录下。")])])}),[],!1,null,null,null);_.default=a.exports}}]);